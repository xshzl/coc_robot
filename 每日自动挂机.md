
---

# 主入口.py 使用说明（初学者版）——每日自动挂机

## 1. 脚本作用

`主入口.py` 可以帮你：

* 自动启动一个或多个机器人
* 每个机器人可以单独设置游戏策略
* 机器人会自动监控自己，如果卡住或没响应，会自动重启
* 支持 Windows 自动计划任务定时启动，实现无人值守挂机

你不需要打开界面，只需要用命令行或 BAT 文件就能启动，这样可以实现每日自动固定时间挂机。

---

## 2. 准备工作

确保你已经通过 `UI入口.py` 正确配置过本程序，并且模拟器和游戏可以正常启动。

---


## 3. 命令行启动

### 3.1 参数说明

| 参数                  | 类型 | 默认值     | 说明                                             |
| ------------------- | -- | ------- | ---------------------------------------------- |
| `--机器人`             | 必填 | 无       | 每个机器人一个标志，唯一标识机器人实例。格式：`标志=XXX`，例如 `标志=模拟器索引0` |
| `雷电索引`              | 可选 | 1       | 对应雷电模拟器的索引                                     |
| `服务器`               | 可选 | `"国际服"` | 游戏服务器名称                                        |
| `最小资源`              | 可选 | 700000  | 欲进攻的最小资源量，低于此值机器人将跳过攻击                         |
| `欲进攻资源建筑靠近地图边缘最小比例` | 可选 | 0.5     | 攻击建筑在地图边缘的最小比例                                 |
| `刷墙`                | 可选 | False   | **布尔参数**，只需写 `刷墙` 即可开启，不需要 `=True`             |
| `刷墙起始金币`            | 可选 | 100000  | 刷墙策略的初始金币阈值                                    |
| `刷墙起始圣水`            | 可选 | 100000  | 刷墙策略的初始圣水阈值                                    |
| `刷主世界`              | 可选 | True    | **布尔参数**，只需写 `刷主世界` 即可开启，不需要 `=True`           |
| `刷夜世界`              | 可选 | False   | **布尔参数**，只需写 `刷夜世界` 即可开启，不需要 `=True`           |

> ⚠️ 注意：布尔参数 **不能写 `=True`**，直接写参数名即可自动开启，例如：
>
> ```bash
> --机器人 标志=模拟器索引0 刷夜世界
> ```

---

### 3.2 命令行启动示例

#### 单机器人启动

```bash
python 主入口.py --机器人 标志=模拟器索引0
```

#### 单机器人开启刷墙与夜世界

```bash
python 主入口.py --机器人 标志=模拟器索引0 刷墙 刷夜世界
```

#### 多机器人启动（可同时开启不同策略）

```bash
python 主入口.py ^
    --机器人 标志=模拟器索引0 刷墙 ^
    --机器人 标志=模拟器索引1 刷夜世界 ^
    --机器人 标志=模拟器索引2
```

> ⚠️ 注意：
>
> 1. 每个机器人必须有唯一 `标志`
> 2. 可选参数不写，则沿用上次保存的设置

---

---

## 4. 编写启动 BAT 文件

在程序所在目录新建一个文件，例如 `启动机器人.bat`，内容如下：

```bat
@echo off
REM ------------------------------
REM coc_robot 多机器人启动脚本（初学者版）
REM ------------------------------

REM 切换到当前目录（确保命令在程序所在目录执行）
cd /d %~dp0

REM ------------------------------
REM 可选：激活虚拟环境（如果你安装 Python 时创建了虚拟环境）
REM 说明：虚拟环境是一个隔离的 Python 环境，用来保证程序依赖完整
REM 如果你没用虚拟环境，可以跳过下面这一行
REM ------------------------------
REM call .venv\Scripts\activate.bat

REM ------------------------------
REM 启动机器人
REM 下面示例启动三个机器人，你可以根据需要修改或增加
REM ------------------------------
python 主入口.py ^ 
    --机器人 标志=模拟器索引0 ^ 
    --机器人 标志=模拟器索引1 ^ 
    --机器人 标志=模拟器索引2

REM 等待用户按键后关闭窗口（运行完后自动暂停，方便看日志）
pause
```

**说明：**

1. `^` 是 BAT 文件的换行符，方便命令写多行
2. 每个 `--机器人 标志=XXX` 对应一个机器人，可以设置不同标志
3. 如果某个参数不写（如服务器、最小资源、刷墙等），机器人会使用上次保存的设置
4. 如果你不想用虚拟环境，直接删除或注释 `call .venv\Scripts\activate.bat` 这一行即可

---

## 5. 命令行启动示例（可选）

不想用 BAT 文件，也可以直接在命令行启动：

单机器人：

```cmd
cd C:\路径\到\coc_robot
python 主入口.py --机器人 标志=模拟器索引0
```

多机器人：

```cmd
python 主入口.py ^ 
    --机器人 标志=模拟器索引0 ^ 
    --机器人 标志=模拟器索引1
```

指定部分参数：

```cmd
python 主入口.py --机器人 标志=模拟器索引0 服务器=国际服 最小资源=300000 开启刷墙
```

---

## 6. 设置 Windows 自动启动（计划任务）

想让机器人每天自动启动挂机，可以用 Windows 计划任务：

1. **打开任务计划程序**：Win + R → 输入 `taskschd.msc` → 回车
2. 点击 **创建任务**
3. **常规** 标签：

   * 名称：如 `挂机机器人`
4. **触发器** 标签：

   * 点击 **新建** → 设置每天或每周固定时间启动
5. **操作** 标签：

   * 点击 **新建**
   * **程序或脚本**：填写你电脑上的 BAT 文件完整路径，例如：

     ```
     C:\Users\你的用户名\coc_robot\启动机器人.bat
     ```
   * **添加参数** 留空即可
6. 点击 **确定** 保存任务

从此，每天到设定时间，机器人就会自动启动挂机，无需人工操作。

---

## 7. 注意事项

* 每个机器人标志必须不同，否则无法同时启动
* 如果机器人未按预期运行，可先用 `UI入口.py` 测试
* 首次运行时，机器人会读取上次保存的设置，未填参数会自动沿用
* 如果你没用虚拟环境，BAT 文件里关于虚拟环境的那一行可以删除
* 高级用户可以通过命令行自定义参数，实现无人值守精细控制

---

